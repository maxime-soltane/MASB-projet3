var flymenuParams={apiUrl:"https://api.flymenu.fr/",appUrl:"https://app.flymenu.fr/",session_token:"",site_token:"",widgetId:"",widgetPosition:"",widgetLoaded:!1,widgetEnabled:!1,widgetIncrementBoutons:!1,cssLoaded:!1,session_lifetime:1440,eans:[],product_eans:[],autoClose:!0,emptyCartPlaceholderHTML:"Votre panier est vide.",emptyCartImageSrc:"https://static.flymenu.fr/images/widget/empty-cart.jpg",currentSessionInfos:null,show_recipe_page:!1,showOrderButtonOnRecipeList:!1};function flymenuGetTimestamp(){return new Date().getTime()}function showFlyMenu(e,t,n,s){if((void 0==t||null==t&&""!=flymenuParams.site_token)&&(t=flymenuParams.site_token),(void 0==n||null==n&&""!=flymenuParams.session_token)&&(n=flymenuParams.session_token),(void 0==s||null==s&&""!=flymenuParams.show_recipe_page)&&(s=flymenuParams.show_recipe_page),loadCss(t),null===document.getElementById("flymenu_mask")){var a=document.createElement("div");a.setAttribute("onclick","hideFlyMenu()"),a.setAttribute("id","flymenu_mask"),document.body.appendChild(a);var i=document.createElement("div");i.setAttribute("id","flymenu_popup"),document.body.appendChild(i);var l=document.createElement("div");l.setAttribute("id","flymenu_popupContent"),i.appendChild(l)}return null===document.getElementById("flymenu_content")&&(null!=n&&""!==n?document.getElementById("flymenu_popupContent").innerHTML='<iframe allow="geolocation" id="flymenu_iframe" src="'+flymenuParams.appUrl+"?session="+n+"&token="+t+"&date="+flymenuGetTimestamp()+'"></iframe>':document.getElementById("flymenu_popupContent").innerHTML='<iframe allow="geolocation" id="flymenu_iframe" src="'+flymenuParams.appUrl+"?token="+t+"&date="+flymenuGetTimestamp()+'"></iframe>'),document.getElementById("flymenu_mask").className+="showed",document.getElementById("flymenu_popup").className+="showed",document.body.className+=" noscroll ",new Promise(function(a,i){var l=new XMLHttpRequest;(null==e||void 0==e)&&(e="");var o="data="+(e=(e=JSON.stringify(e)).replace("&","%26"))+"&site_token="+t+"&skip_recipe_page="+!s+"&address=NR";flymenuParams.eans.length&&(o+="&eans="+JSON.stringify(flymenuParams.eans)),flymenuParams.product_eans.length&&(o+="&product_eans="+JSON.stringify(flymenuParams.product_eans)),null!=n&&""!==n&&e.length<10&&(o+="&session="+n),l.open("POST",flymenuParams.apiUrl+"session/index.php",!0),l.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),l.setRequestHeader("Authorization","Basic Zmx5bWVudV9BUEk6UVpOS2NDcnJ1SFU5eHJhM1NoY0xGOExUclRnM05QYVI="),l.send(o),l.onreadystatechange=function(){if(l.readyState==XMLHttpRequest.DONE&&200==l.status){n=JSON.parse(l.responseText).session_token,null!==document.getElementById("flymenu_popupContent")&&null===document.getElementById("flymenu_content")&&(document.getElementById("flymenu_popupContent").innerHTML='<iframe allow="geolocation" id="flymenu_iframe" src="'+flymenuParams.appUrl+"?session="+n+"&token="+t+"&date="+flymenuGetTimestamp()+'"></iframe>'),saveSessionToken(JSON.parse(l.responseText).session_token),loadFlyMenuWidget();var e=JSON.parse(l.responseText),s=new CustomEvent("Flymenu_PopupOpened",{detail:e});window.dispatchEvent(s),a(e)}},setTimeout(function(){a(null)},2e4)})}function loadCss(e){if(!1==flymenuParams.cssLoaded){var t=flymenuParams.apiUrl+"css/popup.php?site_token="+e+"&v=2019-09-11";if(document.createStyleSheet)document.createStyleSheet(t);else{var n=document.createElement("link");n.rel="stylesheet",n.href="data:text/css,"+encodeURI("@import url('"+t+"');"),document.getElementsByTagName("head")[0].appendChild(n)}flymenuParams.cssLoaded=!0}}function hideFlyMenu(){document.getElementById("flymenu_mask").className=document.getElementById("flymenu_mask").className.replace(/(?:^|\s)showed(?!\S)/g,""),document.getElementById("flymenu_popup").className=document.getElementById("flymenu_popup").className.replace(/(?:^|\s)showed(?!\S)/g,""),document.body.className=document.body.className.replace(" noscroll","");var e=new CustomEvent("Flymenu_PopupClosed");window.dispatchEvent(e)}function flyMenuSetProductEans(e){Array.isArray(e)?flymenuParams.product_eans=e:console.warn("eans doit \xeatre un tableau de codes ean")}function addRecipes(e,t,n){return((void 0==t||null==t)&&""!=flymenuParams.site_token&&(t=flymenuParams.site_token),(void 0==n||null==n&&""!=flymenuParams.session_token)&&(n=flymenuParams.session_token),void 0===e.recipes&&void 0===e.ingredients)?null:new Promise(function(s,a){var i=new XMLHttpRequest,l="data="+(data=(data=JSON.stringify(e)).replace("&","%26"))+"&site_token="+t;null!=n&&""!=n&&(l+="&session="+n),i.open("POST",flymenuParams.apiUrl+"session/addRecipes.php",!0),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),i.setRequestHeader("Authorization","Basic Zmx5bWVudV9BUEk6UVpOS2NDcnJ1SFU5eHJhM1NoY0xGOExUclRnM05QYVI="),i.send(l),i.onreadystatechange=function(){if(i.readyState==XMLHttpRequest.DONE&&200==i.status){if(!0==flymenuParams.widgetEnabled){if("true"==getCookie("flymenu_widget_closed")){var e=new CustomEvent("Flymenu_WidgetOpened");window.dispatchEvent(e)}setCookie("flymenu_widget_closed","false",flymenuParams.session_lifetime),setCookie("flymenu_widget_collapsed","false",flymenuParams.session_lifetime)}saveSessionToken(JSON.parse(i.responseText).session_token),loadFlyMenuWidget(),s(JSON.parse(i.responseText))}},setTimeout(function(){s(null)},2e4)})}function loadFlyMenuWidget(){if(!0==flymenuParams.widgetEnabled){if(!1==flymenuParams.widgetLoaded&&""==flymenuParams.widgetId){var e=document.createElement("div");e.setAttribute("id","flymenu_widget"),document.body.appendChild(e),flymenuParams.widgetId="flymenu_widget",flymenuParams.widgetLoaded=!0;var t=new CustomEvent("Flymenu_WidgetOpened");window.dispatchEvent(t)}else!1==flymenuParams.widgetLoaded&&""!=flymenuParams.widgetId&&(flymenuParams.widgetLoaded=!0);if(loadCss(flymenuParams.site_token),updateFlymenuWidget(),!0==flymenuParams.widgetEnabled){var n="closed_widget=0";null!==flymenuParams.session_token&&void 0!==flymenuParams.session_token&&""!==flymenuParams.session_token&&(n+="&data=&site_token="+flymenuParams.site_token+"&session="+flymenuParams.session_token);var s=new XMLHttpRequest;s.open("POST",flymenuParams.apiUrl+"session/index.php?date="+flymenuGetTimestamp(),!0),s.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),s.setRequestHeader("Authorization","Basic Zmx5bWVudV9BUEk6UVpOS2NDcnJ1SFU5eHJhM1NoY0xGOExUclRnM05QYVI="),s.send(n)}}}function updateFlymenuWidget(){if(""==flymenuParams.session_token){updateFlymenuWidgetData(null);return}var e=new XMLHttpRequest;e.open("GET",flymenuParams.apiUrl+"session/index.php?token="+flymenuParams.session_token+"&action=viewlight&date="+flymenuGetTimestamp(),!0),e.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),e.setRequestHeader("Authorization","Basic Zmx5bWVudV9BUEk6UVpOS2NDcnJ1SFU5eHJhM1NoY0xGOExUclRnM05QYVI="),e.send(),e.onreadystatechange=function(){e.readyState==XMLHttpRequest.DONE&&200==e.status&&updateFlymenuWidgetData(JSON.parse(e.responseText))}}function updateFlymenuWidgetData(e){flymenuParams.currentSessionInfos=e;var t=document.getElementById(flymenuParams.widgetId);if(null!=t){if(!0==flymenuParams.autoClose&&("bottomRight"==flymenuParams.widgetPosition||"bottomLeft"==flymenuParams.widgetPosition||"middleLeft"==flymenuParams.widgetPosition||"middleRight"==flymenuParams.widgetPosition)&&(void 0==e.recipes||0==e.recipes.length)){flymenuClearSession();return}t.innerHTML="";var n="flymenu_widget ";""!=flymenuParams.widgetPosition&&(n+=flymenuParams.widgetPosition),("bottomRight"==flymenuParams.widgetPosition||"bottomLeft"==flymenuParams.widgetPosition||"middleLeft"==flymenuParams.widgetPosition||"middleRight"==flymenuParams.widgetPosition)&&(n+=" float"),t.setAttribute("class",n);var s=document.createElement("div");if(s.setAttribute("id","flymenu_recipes_list"),t.appendChild(s),"bottomRight"==flymenuParams.widgetPosition||"bottomLeft"==flymenuParams.widgetPosition||"middleLeft"==flymenuParams.widgetPosition||"middleRight"==flymenuParams.widgetPosition){var a=document.createElement("div");a.setAttribute("id","flymenu_button_border"),a.setAttribute("class","border-button-closed"),t.appendChild(a);var i=document.createElement("div");i.setAttribute("id","flymenu_button"),i.setAttribute("onclick","flyMenuButtonClick()"),t.appendChild(i);var l=document.createElement("div");l.setAttribute("id","flymenu_close_button"),l.setAttribute("onclick","closeFlyMenuWidget()"),t.appendChild(l);var o=document.createElement("div");o.setAttribute("id","flymenu_dismiss_button"),o.setAttribute("onclick","flyMenuButtonClick()"),"false"!==getCookie("flymenu_widget_closed")&&o.setAttribute("class",""),t.appendChild(o);var r=document.createElement("div");r.setAttribute("id","flymenu_cart_info"),r.setAttribute("onclick","flyMenuButtonClick()");var d=document.createElement("div");d.setAttribute("class","cart-info-text"),d.innerHTML="Vos ingr\xe9dients en livraison ou en drive en cliquant sur “Commander”",r.appendChild(d);var m=document.createElement("div");m.setAttribute("class","order-button"),m.innerHTML="Commander",m.setAttribute("onclick","showFlyMenu()"),r.appendChild(m);var u=document.createElement("div");if(null!=e&&void 0!==e.recipes&&e.recipes.length?1==e.recipes.length?u.innerHTML=e.recipes.length+" recette dans le panier.":u.innerHTML=e.recipes.length+" recettes dans le panier.":u.innerHTML="aucune recette dans le panier.",t.appendChild(r),null!=e&&void 0!==e.recipes&&e.recipes.length){for(var c=Math.min(e.recipes.length,4),p=0;p<e.recipes.length;p++){var f=document.createElement("img");f.setAttribute("src",e.recipes[p].url_picture),i.appendChild(f)}1==c?i.setAttribute("class","one-recipe"):2==c?i.setAttribute("class","two-recipes"):3==c?i.setAttribute("class","three-recipes"):4==c&&i.setAttribute("class","four-recipes")}else{var f=document.createElement("img");f.setAttribute("src",flymenuParams.emptyCartImageSrc),i.appendChild(f),i.setAttribute("class","one-recipe")}}if(null!=e&&void 0!==e.recipes&&e.recipes.length){var y=document.createElement("ul");y.setAttribute("id","flymenu_widget_ul"),s.appendChild(y);for(var p=0;p<e.recipes.length;p++){var g=e.recipes[p].url,h=document.createElement("li");y.appendChild(h);var w=document.createElement("a");w.setAttribute("href",g),h.appendChild(w);var f=document.createElement("img");f.setAttribute("src",e.recipes[p].url_picture),w.appendChild(f);var P=document.createElement("a");P.setAttribute("href",g),h.appendChild(P);var b=document.createElement("h3");b.innerHTML=e.recipes[p].name,P.appendChild(b);var v=document.createElement("div");if(v.setAttribute("class","inputContainer"),h.appendChild(v),e.recipes[p].nb_pers>0){if(!0==flymenuParams.widgetIncrementBoutons){var $=document.createElement("button");$.setAttribute("onclick","decrementNbPers(this)"),$.setAttribute("class","flymenu-input-button decrement-recipe"),v.appendChild($)}var E=document.createElement("input");E.setAttribute("value",e.recipes[p].nb_pers),E.setAttribute("onchange","updateNbPers(this, '"+flymenuParams.session_token+"', '"+e.recipes[p].id+"')"),E.setAttribute("class","flymenu-input-number"),v.appendChild(E);var k=document.createElement("span");if(k.setAttribute("class","nbpers-legend"),k.innerHTML="pers.",v.appendChild(k),!0==flymenuParams.widgetIncrementBoutons){var C=document.createElement("button");C.setAttribute("onclick","incrementNbPers(this)"),C.setAttribute("class","flymenu-input-button increment-recipe"),v.appendChild(C)}}var T=document.createElement("span");T.setAttribute("class","remove-recipe"),T.setAttribute("onclick","removeRecipe('"+e.recipes[p].id+"')");var I=document.createElement("img");I.setAttribute("src",flymenuParams.apiUrl+"css/img/delete.png"),I.setAttribute("width","10"),I.setAttribute("class","remove-img"),T.appendChild(I),h.appendChild(T)}if(!0==flymenuParams.showOrderButtonOnRecipeList){var m=document.createElement("div");m.setAttribute("class","order-button"),m.innerHTML="Commander mes ingredients",m.setAttribute("onclick","showFlyMenu()"),s.appendChild(m)}}else{var B=document.createElement("div");B.setAttribute("class","basket-placeholder"),(emptyBasketContent=document.createElement("span")).setAttribute("class","basket-placeholder-content"),emptyBasketContent.innerHTML=flymenuParams.emptyCartPlaceholderHTML,B.appendChild(emptyBasketContent),s.appendChild(B)}var U=0;if(null!=e&&void 0!==e.recipes&&e.recipes.length&&(U=e.recipes.length),U>0){var A=document.createElement("div");A.setAttribute("id","flymenu_recipe_count_container"),A.innerHTML=U,t.appendChild(A)}for(var _=[],p=0;p<e.recipes.length;p++){var x=e.recipes[p];_.push({name:x.name,nb_pers:x.nb_pers,site_id:x.site_id,recipe_id:x.id})}var M=new CustomEvent("Flymenu_nbRecipesUpdated",{detail:{recipesCount:U,recipes:_}});window.dispatchEvent(M),("bottomRight"==flymenuParams.widgetPosition||"bottomLeft"==flymenuParams.widgetPosition||"middleLeft"==flymenuParams.widgetPosition||"middleRight"==flymenuParams.widgetPosition)&&("true"==getCookie("flymenu_widget_closed")&&closeFlyMenuWidget(),"true"==getCookie("flymenu_widget_collapsed")&&(document.getElementById("flymenu_recipes_list").setAttribute("class","collapsed"),document.getElementById("flymenu_dismiss_button").setAttribute("class","collapsed"),document.getElementById("flymenu_widget").setAttribute("class",document.getElementById("flymenu_widget").getAttribute("class")+" collapsed"),document.getElementById("flymenu_button_border").setAttribute("class","")),setTimeout(function(){document.getElementById("flymenu_widget").classList.add("transition")},100))}}function incrementNbPers(e){var t=e.parentNode.getElementsByTagName("input")[0],n=parseInt(t.value)+1;t.value=n,t.onchange()}function decrementNbPers(e){var t=e.parentNode.getElementsByTagName("input")[0],n=parseInt(t.value)-1;n>=1&&(t.value=n,t.onchange())}function updateRecipeNbPers(e,t,n){var s=flymenuParams.apiUrl+"session/updateRecipeNbPers.php?session="+flymenuParams.session_token+"&nb_pers="+e+"&date="+flymenuGetTimestamp();return null!=t?s+="&site_recipe_id="+t:void 0!=n&&(s+="&recipe_id="+n),new Promise(function(e,t){var n=new XMLHttpRequest;n.open("GET",s,!0),n.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),n.setRequestHeader("Authorization","Basic Zmx5bWVudV9BUEk6UVpOS2NDcnJ1SFU5eHJhM1NoY0xGOExUclRnM05QYVI="),n.send(),n.onreadystatechange=function(){n.readyState==XMLHttpRequest.DONE&&200==n.status&&(updateFlymenuWidgetData(JSON.parse(n.responseText)),e(JSON.parse(n.responseText)))},setTimeout(function(){e(null)},2e4)})}function updateNbPers(e,t,n){if(isNaN(parseInt(e.value,10))){e.value=e.defaultValue;return}var s=document.getElementById("flymenu_widget_ul").scrollTop,a=new XMLHttpRequest;a.open("GET",flymenuParams.apiUrl+"session/index.php?token="+flymenuParams.session_token+"&action=updateNbpers&recipe_id="+n+"&nb_pers="+e.value+"&date="+flymenuGetTimestamp(),!0),a.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),a.setRequestHeader("Authorization","Basic Zmx5bWVudV9BUEk6UVpOS2NDcnJ1SFU5eHJhM1NoY0xGOExUclRnM05QYVI="),a.send(),a.onreadystatechange=function(){a.readyState==XMLHttpRequest.DONE&&200==a.status&&(updateFlymenuWidgetData(JSON.parse(a.responseText)),document.getElementById("flymenu_widget_ul").scrollTop=s)}}function removeIngredient(e){var t=new XMLHttpRequest;t.open("GET",flymenuParams.apiUrl+"session/index.php?token="+flymenuParams.session_token+"&action=removeIngredient&ingredient="+e+"&date="+flymenuGetTimestamp(),!0),t.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),t.setRequestHeader("Authorization","Basic Zmx5bWVudV9BUEk6UVpOS2NDcnJ1SFU5eHJhM1NoY0xGOExUclRnM05QYVI="),t.send(),t.onreadystatechange=function(){t.readyState==XMLHttpRequest.DONE&&200==t.status&&updateFlymenuWidgetData(JSON.parse(t.responseText))}}function setIngredientQty(e,t,n){var s=new XMLHttpRequest;s.open("GET",flymenuParams.apiUrl+"session/index.php?token="+flymenuParams.session_token+"&action=setIngredientQty&ingredient="+e+"&qty="+t+"&unit="+n+"&date="+flymenuGetTimestamp(),!0),s.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),s.setRequestHeader("Authorization","Basic Zmx5bWVudV9BUEk6UVpOS2NDcnJ1SFU5eHJhM1NoY0xGOExUclRnM05QYVI="),s.send(),s.onreadystatechange=function(){s.readyState==XMLHttpRequest.DONE&&200==s.status&&updateFlymenuWidgetData(JSON.parse(s.responseText))}}function clearIngredients(){var e=new XMLHttpRequest;e.open("GET",flymenuParams.apiUrl+"session/index.php?token="+flymenuParams.session_token+"&action=clearIngredients&date="+flymenuGetTimestamp(),!0),e.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),e.setRequestHeader("Authorization","Basic Zmx5bWVudV9BUEk6UVpOS2NDcnJ1SFU5eHJhM1NoY0xGOExUclRnM05QYVI="),e.send(),e.onreadystatechange=function(){e.readyState==XMLHttpRequest.DONE&&200==e.status&&updateFlymenuWidgetData(JSON.parse(e.responseText))}}function removeRecipeFromSid(e,t){void 0==t&&(t=flymenuParams.session_token);var n=new XMLHttpRequest;n.open("GET",flymenuParams.apiUrl+"session/removeRecipe.php?session="+t+"&site_recipe_id="+e+"&date="+flymenuGetTimestamp(),!0),n.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),n.setRequestHeader("Authorization","Basic Zmx5bWVudV9BUEk6UVpOS2NDcnJ1SFU5eHJhM1NoY0xGOExUclRnM05QYVI="),n.send(),n.onreadystatechange=function(){n.readyState==XMLHttpRequest.DONE&&200==n.status&&updateFlymenuWidgetData(JSON.parse(n.responseText))}}function removeRecipe(e,t){null==t&&(t=flymenuParams.session_token);var n=new XMLHttpRequest;n.open("GET",flymenuParams.apiUrl+"session/index.php?token="+t+"&action=removeRecipe&recipe_id="+e+"&date="+flymenuGetTimestamp(),!0),n.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),n.setRequestHeader("Authorization","Basic Zmx5bWVudV9BUEk6UVpOS2NDcnJ1SFU5eHJhM1NoY0xGOExUclRnM05QYVI="),n.send(),n.onreadystatechange=function(){n.readyState==XMLHttpRequest.DONE&&200==n.status&&updateFlymenuWidgetData(JSON.parse(n.responseText))}}function flyMenuButtonClick(){"collapsed"==document.getElementById("flymenu_recipes_list").getAttribute("class")?(document.getElementById("flymenu_recipes_list").setAttribute("class",""),document.getElementById("flymenu_dismiss_button").setAttribute("class",""),document.getElementById("flymenu_button_border").setAttribute("class","border-button-closed"),document.getElementById("flymenu_widget").classList.remove("collapsed"),setCookie("flymenu_widget_collapsed","false",flymenuParams.session_lifetime)):(document.getElementById("flymenu_recipes_list").setAttribute("class","collapsed"),document.getElementById("flymenu_dismiss_button").setAttribute("class","collapsed"),document.getElementById("flymenu_widget").setAttribute("class",document.getElementById("flymenu_widget").getAttribute("class")+" collapsed"),document.getElementById("flymenu_button_border").setAttribute("class",""),setCookie("flymenu_widget_collapsed","true",flymenuParams.session_lifetime))}function closeBtnClick(){document.getElementById("flymenu-widget-heading").onclick()}function closeFlyMenuWidget(){var e=document.getElementById(flymenuParams.widgetId);if(e){document.getElementById("flymenu_recipes_list").setAttribute("class","collapsed"),document.getElementById("flymenu_dismiss_button").setAttribute("class","collapsed"),document.getElementById("flymenu_widget").classList.add("collapsed"),setCookie("flymenu_widget_closed","true",flymenuParams.session_lifetime),setCookie("flymenu_widget_collapsed","true",flymenuParams.session_lifetime),e.classList.add("closed");var t=document.getElementById("flymenu-widget-heading");t&&t.setAttribute("onclick","showFlyMenuWidget()"),"bottomRight"!==flymenuParams.widgetPosition&&"bottomLeft"!==flymenuParams.widgetPosition&&setCookie("flymenu_widget_closed","true",flymenuParams.session_lifetime);var n=new CustomEvent("Flymenu_WidgetClosed");if(window.dispatchEvent(n),!0==flymenuParams.widgetEnabled){var s="closed_widget=1";null!==flymenuParams.session_token&&void 0!==flymenuParams.session_token&&""!==flymenuParams.session_token&&(s+="&data=&site_token="+flymenuParams.site_token+"&session="+flymenuParams.session_token);var a=new XMLHttpRequest;a.open("POST",flymenuParams.apiUrl+"session/index.php",!0),a.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),a.setRequestHeader("Authorization","Basic Zmx5bWVudV9BUEk6UVpOS2NDcnJ1SFU5eHJhM1NoY0xGOExUclRnM05QYVI="),a.send(s)}}}function showFlyMenuWidget(){var e=document.getElementById(flymenuParams.widgetId);if(e){e.classList.remove("closed");var t=document.getElementById("flymenu-widget-heading");if(t&&t.setAttribute("onclick","closeFlyMenuWidget()"),"true"==getCookie("flymenu_widget_closed")){var n=new CustomEvent("Flymenu_WidgetOpened");window.dispatchEvent(n)}"bottomRight"!==flymenuParams.widgetPosition&&"bottomLeft"!==flymenuParams.widgetPosition&&setCookie("flymenu_widget_closed","false",flymenuParams.session_lifetime)}else{if("true"==getCookie("flymenu_widget_closed")){var n=new CustomEvent("Flymenu_WidgetOpened");window.dispatchEvent(n)}!1==flymenuParams.autoClose&&(setCookie("flymenu_widget_closed","false",flymenuParams.session_lifetime),setCookie("flymenu_widget_collapsed","false",flymenuParams.session_lifetime),loadFlyMenuWidget())}}function flyMenuInit(e){void 0!==e.site_token&&null!==e.site_token&&(flymenuParams.site_token=e.site_token),["973079k1YI8r7L1U6W55pdgpq0CC1RdB","ee2d5048dab02afaf663f9b00a410dc4623c47215826a7b2a00ab68edb1da7f0b95f7de3e296d9d6735217c21908e4ad50eb","1db10c7d5283ceb067e5517aad837d7030c2bade2d69251c70146eeccd23e6efe366086a8417a61f40eeb187d7ea0d9257bc","4613236c5882ceb9512da2002647d91787293371af51235093cf4986a1883706a3c5f9a26549c291d50fa18da2cce98348c0"].indexOf(e.site_token)>=0&&(flymenuParams.appUrl="https://app.flymenu.fr/2022/"),null!==e.flymenuWidgetId&&void 0!==e.flymenuWidgetId?(flymenuParams.widgetId=e.flymenuWidgetId,flymenuParams.widgetEnabled=!0):void 0!==e.flymenuWidgetPosition&&null!==e.flymenuWidgetPosition&&(flymenuParams.widgetPosition=e.flymenuWidgetPosition,flymenuParams.widgetEnabled=!0),void 0===e.session_lifetime||null===e.session_lifetime||isNaN(parseInt(e.session_lifetime,10))||(flymenuParams.session_lifetime=e.session_lifetime),void 0!==e.emptyCartPlaceholderHTML&&null!==e.emptyCartPlaceholderHTML&&(flymenuParams.emptyCartPlaceholderHTML=e.emptyCartPlaceholderHTML),void 0!==e.emptyCartImageSrc&&null!==e.emptyCartImageSrc&&(flymenuParams.emptyCartImageSrc=e.emptyCartImageSrc),void 0!==e.autoClose&&null!==e.autoClose&&(!0==e.autoClose||!1==e.autoClose)&&(flymenuParams.autoClose=e.autoClose),void 0!==e.show_recipe_page&&null!==e.show_recipe_page&&(flymenuParams.show_recipe_page=e.show_recipe_page),void 0!==e.widgetIncrementBoutons&&null!==e.widgetIncrementBoutons&&(flymenuParams.widgetIncrementBoutons=e.widgetIncrementBoutons),getCookie("flymenu_session")&&getCookie("flymenu_session").length?(flymenuParams.session_token=getCookie("flymenu_session"),loadFlyMenuWidget()):!1==flymenuParams.autoClose&&"false"==getCookie("flymenu_widget_closed")&&loadFlyMenuWidget(),void 0!==e.showOrderButtonOnRecipeList&&(!0==e.showOrderButtonOnRecipeList||!1==e.showOrderButtonOnRecipeList)&&(flymenuParams.showOrderButtonOnRecipeList=e.showOrderButtonOnRecipeList)}function saveSessionToken(e){setCookie("flymenu_session",e,flymenuParams.session_lifetime),flymenuParams.session_token=e}function flymenuClearSession(){deleteCookie("flymenu_session"),flymenuParams.session_token="",!0==flymenuParams.widgetEnabled&&""!=flymenuParams.widgetId&&document.getElementById(flymenuParams.widgetId)&&("flymenu_widget"==flymenuParams.widgetId?(document.getElementById(flymenuParams.widgetId).remove(),flymenuParams.widgetLoaded=!1,flymenuParams.widgetId=""):(document.getElementById(flymenuParams.widgetId).innerHTML="",document.getElementById(flymenuParams.widgetId).classList.remove("flymenu_widget"),flymenuParams.widgetLoaded=!1),setCookie("flymenu_widget_closed","true",flymenuParams.session_lifetime));var e=new CustomEvent("Flymenu_nbRecipesUpdated",{detail:{recipesCount:0}});window.dispatchEvent(e);var e=new CustomEvent("Flymenu_SessionClosed");window.dispatchEvent(e)}function flyMenuSetEans(e){Array.isArray(e)?flymenuParams.eans=e:console.warn("eans doit \xeatre un tableau de codes ean")}function getFlyMenuSessionInfos(){return flymenuParams.currentSessionInfos}function deleteCookie(e){setCookie(e,"",-10)}function setCookie(e,t,n){var s="";if(n){var a=new Date;a.setTime(a.getTime()+6e4*n),s="; expires="+a.toUTCString()}document.cookie=e+"="+(t||"")+s+"; path=/"}function getCookie(e){for(var t=e+"=",n=document.cookie.split(";"),s=0;s<n.length;s++){for(var a=n[s];" "==a.charAt(0);)a=a.substring(1,a.length);if(0==a.indexOf(t))return a.substring(t.length,a.length)}return null}function sendStat(e,t,n){if(getCookie("flymenu_session")&&getCookie("flymenu_session").length)flymenuParams.session_token=getCookie("flymenu_session");else{var s=generateFlymenuToken(30);flymenuParams.session_token=s,setCookie("flymenu_session",s,flymenuParams.session_lifetime)}var a=new XMLHttpRequest;a.open("POST",flymenuParams.apiUrl+"session/event.php?session="+flymenuParams.session_token+"&event="+e+"&site_token="+n,!0),a.setRequestHeader("Content-Type","application/json; charset=UTF-8"),a.setRequestHeader("Authorization","Basic Zmx5bWVudV9BUEk6UVpOS2NDcnJ1SFU5eHJhM1NoY0xGOExUclRnM05QYVI="),a.send(JSON.stringify(t))}function generateFlymenuToken(e){for(var t=new Date().getTime(),n="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",s="",a=0;a<e;a++)s+=n[Math.floor(Math.random()*n.length)];return t+s}window.addEventListener("message",function(e){if("hideFlyMenu"==e.data)hideFlyMenu();else if("object"==typeof e.data&&null!==e){if("goToUrl"==e.data.type)window.open(e.data.url,"_blank").focus();else if("tag"==e.data.type){var t=window[e.data.messageDest];t&&e.data.messageData&&"object"==typeof t&&t.push(e.data.messageData)}}}),function(){if("function"==typeof window.CustomEvent)return!1;function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}e.prototype=window.Event.prototype,window.CustomEvent=e}();